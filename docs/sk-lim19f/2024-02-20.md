#### 8.1.1.2 우분투의 네트워크 설정

-   우분투의 네트워크 설정 파일

```
/etc/network/interfaces
```

-   우분투 네트워크 설정 예제

```
auto eth0
iface eht0 inet static
      address 10.1.1.6
      netmask 255.255.255.0
      gateway 10.10.10.1
      dns-nameserver 10.100.100.2


auto eth1
iface eht1 inet static
      address 20.1.1.6
      netmask 255.255.255.0
      gateway 20.10.10.1
      dns-nameserver 219.250.36.130


auto eth2
iface eth2 inet dhcp
```

-   우분투에서 네트워크 서비스를 시작/정지/재시작하기 위해서는 다음 명령어 사용

```
$ /etc/init.d/networking start
$ /etc/init.d/networking stop
$ /etc/init.d/networking reload
$ /etc/init.d/networking restart
$ /etc/init.d/networking force-reload
```

## 8.2 서버의 라우팅 테이블

-   네트워크 장비와 같이 서버에서도 외부 네트워크와 통신하기 위해 라우팅 테이블을 가지고 있음

### 8.2.1 서버의 라우팅 테이블

-   서버의 라우팅 테이블 항목

```
10.10.20.0         24         10.10.10.1         eth1         10
   목적지          서브넷          게이트웨이         인터페이스     우선순위
```

-   목적지 네트워크와 서브넷은 서버가 통신하려는 목적지 IP 주소에 맞는 라우팅을 선택하는 기준이 됨
-   라우팅할 때 목적지 네트워크 주소와 서브넷으로 표현되는 목적지 네트워크 범위내에 서버가 통신하려느 IP 줏가 속한 라우팅 테이블을 선택
-   라우팅 테이블의 게이트웨이는 선택한 목적지로 가기위한 넥스트 홉
-   인터페이스는 서버의 네트워크 카드를 말하고 라우팅에서 어떤 물리적인 경로로 패킷을 내보낼지 설정
-   우선순위(메트릭)는 동일한 라우팅 테이블이 두 개 이상 존재할 때 어떤 라우팅 테이블을 선택할지 정하는 값

### 8.2.2 리눅스 서버의 라우팅 확인 및 관리

-   라우팅 테이블을 확인하기 위해서는 ip route 명령어를 사용할 수 있음

```
$ ip route
```

-   ip 명령어 외에도 리눅스 서버의 네트워크 상태를 확인할 수 있는 명령어인 netstat에 r 옵션을 추가하면 라우팅 테이블을 편하게 확인할 수 있음

```
$ netstat -r
```

-   여기에 n 옵션을 추가로 사용하면 화면에 표기될 때, 실제 IP 정보가 표기되어 좀 더 직관적인 라우팅 테이블을 확인할 수 있음

```
$ netstat -rn
```

-   서버의 네트워크 인터페이스가 한 개 뿐이라면 서버에 라우팅 테이블을 추가하거나 삭제할 필요가 거의 없음
-   서버가 연결된 동일한 네트워크로는 로컬 통신을 하고 다른 원격지 네트워크에 대해서는 디폴트 라우팅을 통해 게이트웨이로 지정된 인터페이스로 전송하면 되기 때문
-   리눅스 서버에서 라우팅 테이블을 추가하는 설정은 다음과 같음

```
$ route add { -host | -net } Target[/prefix] [gw Gw] [metric M] [[dev] if]
```

-   라우팅 테이블에 우선순위를 부여해 목적지에 대한 게이트웨이를 액티브-스탠바이 형태로 구성할 수 있음
    -   더 작은 메트릭 값을 가진 라우팅 테이블이 더 높은 우선순위를 가지게 되어 액티브 상태가 되고 높은 메트릭 값을 가진 라우팅 테이블이 스탠바이 상태가 됨
    -   액티브 경로에 문제가 발생하면 라우팅 테이블에서 해당 경로가 삭제되어 스탠바이로 통신이 페일오버(Fail-over)됨

#### 8.2.2.1 CentOS의 영구적 라우팅 설정

-   CentOS에서는 다음과 같이 별도 파일을 만들어 라우팅을 설정

```
/etc/sysconfig/network-scripts/route-장치명
```

#### 8.2.2.2 우분투의 영구적 라우팅 설정

-   우분투에서는 네트워크 설정에서 사용했던 interfaces 파일에 라우팅 설정을 함

```
$ up route add [-host|-net] <host/net>/<mask> gw <host/IP> dev <Interface>
```
