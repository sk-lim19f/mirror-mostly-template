### 7.2.5 DNS 주요 레코드

-   도메인에는 다양한 내용을 매핑할 수 있는 레코드가 있음

#### 7.2.5.1. A(IPv4) 레코드

-   A 레코드는 기본 레코드로 도메인 주소를 IP 주소로 변환하는 레코드
-   사용자가 DNS에 질의한 도메인 주소를 A 레코드에 설정된 IP 주소로 응답
-   하나의 A 레코드에는 한 개의 도메인 주소와 한 개의 IP 주소가 1:1로 매핑되는데 동일한 도메인을 가진 A 레코드를 여러개 만들어 서로 다른 IP 주소와 매핑할 수 있음
-   반대로 다수의 도메인에 동일한 IP를 매핑한 A 레코드를 만들 수 있음

#### 7.2.5.2 AAAA(IPv6) 레코드

-   A 레코드가 IPv4 주소 체계에서 사용되는 레코드라면 AAAA 레코드는 IPv6 주소 체계에서 사용되는 레코드
-   역할은 A 레코드와 같음

#### 7.2.5.3 CNAME(Canonical Name) 레코드

-   CNAME 레코드는 별칭 이름을 사용하게 해주는 레코드
-   레코드값에 IP 주소를 매핑하는 A 레코드와 달리 CMAME 레코드는 도메인 주소를 매핑
-   대표적인 예로 'www'가 있음

#### 7.2.5.4 SOA(Start of Authority) 레코드

-   도메인 영역에 대한 권한을 나타내는 레코드
-   현재 네임 서버가 이 도메인 영역에 대한 관리 주체임을 의미하므로 해당 도메인에 대해서는 다른 네임 서버에 질의하지 않고 직접 응답
-   도메인 영역 선언 시 SOA 레코드는 필수 항목이므로 반드시 만들어야 함

#### 7.2.5.5 NS(Name Server) 레코드

-   도메인에 대한 권한이 있는 네임 서버 정보를 설정하는 레코드
-   NS 레코드의 경우, 권한이 있는 네임 서버 정보를 해당 도메인에 설정하는 역할 외에 하위 도메인에 대한 권한을 다른 네임 서버로 위임(Delegate)하는 역할로도 많이 사용

#### 7.2.5.6 MX(Mail eXchange) 레코드

-   메일 서버를 구성할 때 사용되는 레코드

#### 7.2.5.7 PTR(Pointer) 레코드

-   A 레코드는 도메인 주소에 대한 질의를 IP로 응답하기 위한 레코드이고 PTR 레코드는 그와 반대로 IP 주소에 대한 질의를 도메인 주소로 응답하기 위한 레코드
-   A 레코드가 정방향 조회용 레코드라면 PTR 레코드는 역방향 조회용 레코드

#### 7.2.5.8 TXT(TeXT) 레코드

-   도메인에 대한 설명과 같이 간단한 텍스트를 입력할 수 있는 레코드

### 7.2.6 DNS에서 알아두면 좋은 내용

#### 7.2.6.1 도메인 위임

-   도메인은 그 도메인에 대한 정보를 관리할 수 있는 네임 서버를 지정하지만 도메인 내의 모든 레코드를 그 네임 서버가 직접 관리하지 않고 일부 영역에 대해서는 다른 곳에서 레코드를 관리하도록 위임하기도 함
-   자신이 가진 도메인 관리 권한을 다른 곳으로 일부 위임해 위임한 곳에서 세부 레코드를 관리하도록 하는 것
-   CDN을 이용하거나 GSLB를 사용하는 것이 대표적
-   도메인 위임 기능을 쓰면 특정 영역을 다른 네임 서버에 관리할 수 있는 권한을 위임
-   특정 영역에 대한 관리 주체를 분리하는 용도로 사용할 수 있어 계열사에서 특정 도메인을 분리하거나 GSLB 등 다양한 용도로 사용

#### 7.2.6.2 TTL

-   도메인의 TTL값은 DNS에 질의해 응답받은 결과값을 캐시에서 유지하는 시간을 뜻함
-   로컬 캐시에 저장된 도메인 정보를 무작정 계속 갖고 있는 것이 아니라 DNS에 설정된 TTL 값에 따라 그 시간만 로컬 캐시에 저장
-   DNS 서버에서 TTL 값을 늘려 캐시를 많이 이용하면 DNS 재귀적 쿼리로 인한 응답 시간을 많이 줄일 수 있고 결과적으로 전체적인 네트워크 응답 시간이 단축
-   하지만 DNS에서 해당 도메인 관련 정보가 변경되었을 때, TTL 값이 크면 새로 변경된 값으로 DNS 정보 갱신이 그만큼 지연되는 단점이 발생
-   반대로 TTL 값이 너무 작으면 DNS의 정보 갱신이 빨라지므로 DNS 쿼리량이 늘어나 DNS 서버 부하가 증가

#### 7.2.6.3 화이트 도메인

-   KISA에서는 불법적인 방법으로 발송되는 스팸메일 차단활동을 하고 있음
-   이를 위해 정상적인 도메인을 인증, 관리하는 제도가 '화이트 도메인'
-   반대로 불법적인 스팸메일을 발송하는 사이트를 실시간 블랙리스트 정보로 관리해 메일 발송을 제한
-   실시간 블랙리스트를 RBL(Realtime Blackhole List, Realtime Blocking List)라고 함

#### 7.2.6.4 한글 도메인

-   도메인 주소는 영문뿐만 아니라 "http://대한민국.한국"처럼 한글로 주소를 만들 수 있음
-   사용자가 도메인을 한글로 등록하고 사용하기 위해 DNS에서는 해당 한글을 "퓨니코드"로 변경하고 이 퓨니코드로 DNS에 도메인을 생성해야 함

### 7.2.8 DNS 설정(Linux)

-   bind 패키지 설치

```
$ yum install -y bind
```

-   bind 버전 확인

```
$ /usr/sbin/named -v
```

-   초기 설정은 bind가 설치된 로컬 서버에서만 도메인 질의를 할 수 있게 되어 있음
-   DNS를 위한 53번 포트에 대한 Listen과 질의 허용(Allow-Query)이 로컬 호스트(localhost/127.0.0.1)로 설정되어 있기 때문
-   로컬뿐만 아니라 외부에서도 도메인 질의를 하려면 다음과 같이 네임 서버 설정 파일(named.conf)의 option 안에 'listen-on port 53','listen-on-v6 port 53', 'allow-query'항목 값을 any로 수정

```
/etc/named.conf

options {
        listen-on port 53 { any; };    // 기본값 127.0.0.1;
        listen-on-v6 port 53 { any; }; // 기본값 ::1
directory       "/var/named";
... 생략 ...
        allow-query       { any;};    // 기본값 localhost
... 생략 ...
```

-   bind에서 관리할 도메인 영역을 추가하기 위해 도메인 영역을 관리하는 설정 파일(named.rfc1912.zones)에 신규 도메인 영역(zigispace.kr)을 추가

```
/etc/named.rfc1912.zones

zone "zigispace.kr" IN {
        type master;
        file "zigispace.kr.zone";
        allow-update { none; };
};
```

-   도메인 영역을 동기화할 슬레이브 서버는 따로 없으니 allow-update는 'none'으로 설정
-   도메인 영역을 지정한 후에는 해당 도메인에 대한 존(Zone) 파일을 만들어 도메인의 속성과 레코드를 정의

```
$ cp /var/named/named.empty /var/named/zigispace.kr.zone
```

-   복사한 파일을 수정

```
$TTL 3H
@       IN SOA  ns.zigispace.kr. root.zigispace.kr(
                                       0       ; serial
                                       1D      ; refresh
                                       1H      ; retry
                                       1W      ; expire
                                       3H #    ; minimum
    NS      ns.zigispace.kr.
    A       10.10.10.20
ns  A       10.1.1.5
```

-   만들어진 존 파일은 bind에서 사용할 수 있도록 권한 수정

```
$ chown root:named /var/named/zigispace.kr.zone
```

-   bind 서비스 데몬 실행

```
$ systemctl start named.service
```
